# specs/001-auth/tasks/T-008.md

## Task: User Model Unit Tests

## Type
unit-test

## Context
- **Phase**: Phase 2 - Test Infrastructure
- **Builds on**: T-001 (User Model Contract Tests)
- **Blocks**: T-011 (User Model Implementation)

## Predecessors

### Cross-Feature
| Feature | File | Task | Import Statement |
|---------|------|------|------------------|
| 001A-infrastructure | backend/canvas/models/__init__.py | 001A-infrastructure/T-006 | `from canvas.models import TimestampMixin` |

### Within Feature
| Task | File | What This Task Imports |
|------|------|------------------------|
| T-001 | tests/test_user_model_contract.py | User model contract interface |

## Scope
- **CREATE**: `backend/tests/test_user_model.py`

## Contract
```python
def test_user_creation_with_defaults():
    """Test User model creates with default values."""
    assert user.role == UserRole.VIEWER
    assert user.id is not None

def test_user_email_uniqueness():
    """Test email unique constraint enforcement."""
    with pytest.raises(IntegrityError):
        # duplicate email creation

def test_user_role_enum_validation():
    """Test UserRole enum accepts valid values."""
    assert UserRole.ADMIN == "admin"
    assert UserRole.GM == "gm"
    assert UserRole.VIEWER == "viewer"

def test_user_password_hash_required():
    """Test password_hash field is required."""
    with pytest.raises(IntegrityError):
        # user without password_hash

def test_user_timestamps_auto_populated():
    """Test created_at and updated_at are auto-populated."""
    assert user.created_at is not None
    assert user.updated_at is not None
```

## Logic
1. Import User model and UserRole enum from contract
2. Test User model field validation and constraints
3. Test UserRole enum values match schema specification
4. Test database constraints (unique email, required fields)
5. Test TimestampMixin integration (created_at, updated_at)

## Verification
- [ ] All test methods contain assert statements or pytest.raises
- [ ] Tests cover User model validation rules
- [ ] Tests verify database constraints
- [ ] UserRole enum tests validate string values

## LOC Estimate
~80 lines