# specs/001A-infrastructure/tasks/T-008.md

## Task: FastAPI App Implementation

## Type
implementation

## Context
- **Phase**: API Layer
- **Builds on**: T-004 (Health endpoint contract), T-006 (Backend core)
- **Blocks**: T-009 (Health endpoint implementation)

## Predecessors

### Cross-Feature
| Feature | File | Task | Import Statement |
|---------|------|------|------------------|

### Within Feature
| Task | File | What This Task Imports |
|------|------|------------------------|
| T-006 | backend/canvas/config.py | Settings class |
| T-006 | backend/canvas/__init__.py | success_response function |

## Scope
- **CREATE**: `backend/canvas/main.py`

## Contract
```python
from fastapi import FastAPI

def create_app() -> FastAPI:
    """Create and configure FastAPI application instance.
    
    Returns:
        FastAPI: Configured app with middleware, CORS, exception handlers
    """
    ...
```

## Logic
1. Import FastAPI, CORSMiddleware, HTTPException, Request, uuid
2. Import Settings from canvas.config
3. Import success_response from canvas
4. Define create_app() function that returns FastAPI instance
5. Create FastAPI app with title="Canvas API"
6. Load settings = Settings()
7. Add CORS middleware with origins from settings.cors_origins
8. Add request ID middleware that generates UUID and adds X-Request-ID header
9. Add exception handler for HTTPException that returns JSON `{"error": {"code": exc.status_code, "message": exc.detail, "request_id": request_id}}`
10. Add exception handler for general Exception that returns JSON `{"error": {"code": 500, "message": "Internal server error", "request_id": request_id}}` and logs the traceback
11. Return configured app

## Verification
- [ ] Imports resolve without error
- [ ] create_app() returns FastAPI instance
- [ ] CORS middleware configured with settings
- [ ] Request ID middleware adds header
- [ ] Exception handlers return proper error envelope format

## LOC Estimate
~80 lines