# specs/001A-infrastructure/tasks/T-012.md

## Task: Seed Script Implementation

## Type
implementation

## Context
- **Phase**: Phase 4: Core Logic
- **Builds on**: T-007 (Database Implementation)
- **Blocks**: None
- **Requirements**: FR-INFRA-015

## Predecessors

### Cross-Feature
| Feature | File | Task | Import Statement |
|---------|------|------|------------------|

### Within Feature
| Task | File | What This Task Imports |
|------|------|------------------------|
| T-007 | backend/canvas/db.py | AsyncSessionLocal, get_db_session |

## Scope
- **CREATE**: `backend/canvas/seed.py`

## Contract
```python
# seed.py
import asyncio
import json
from canvas.db import AsyncSessionLocal

async def seed_users():
    """Create dev users if they don't exist."""
    ...

async def seed_sample_data():
    """Create sample VBUs and canvases if they don't exist."""
    ...

async def main():
    """Main seed function - idempotent."""
    ...

if __name__ == "__main__":
    asyncio.run(main())
```

## Logic
1. Import async database session and required models
2. Implement seed_users function to create admin, gm, viewer test users
3. Implement seed_sample_data function to create sample VBUs and canvases
4. Make all operations idempotent using SELECT before INSERT
5. Implement main function that runs all seed operations
6. Add CLI interface that can be run with `python -m canvas.seed`
7. Output JSON success/error messages to stdout for CLI mandate

## Verification
- [ ] Script can be run with `python -m canvas.seed`
- [ ] Creates admin user with email admin@canvas.dev
- [ ] Creates GM user with email gm@canvas.dev  
- [ ] Creates viewer user with email viewer@canvas.dev
- [ ] Running twice produces no errors or duplicates
- [ ] Outputs JSON to stdout for success/error reporting
- [ ] All database operations use async sessions

## LOC Estimate
~60 lines